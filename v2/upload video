<div class="video-box" id="videoContainer">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h6 class="fw-bold m-0 text-warning">ðŸŽ¬ VIDEO FILE MANAGER</h6>
        <button class="btn btn-sm btn-outline-danger" onclick="document.getElementById('videoContainer').remove()">Hapus</button>
    </div>

    <div class="ratio ratio-16x9 video-frame">
        <video id="playerGibran" controls crossorigin="anonymous">
            <source id="videoSource" src="https://res.cloudinary.com/dumqnwl9g/video/upload/v1/video-kamu.mp4" type="video/mp4">
        </video>
    </div>

    <button id="upload_widget" class="btn btn-warning w-100 fw-bold mb-3" style="color: #000;">
        ðŸ“¤ UPLOAD VIDEO BARU
    </button>

    <div class="row g-2">
        <div class="col-6">
            <a id="btnDownload" href="#" download class="btn btn-success w-100 fw-bold">ðŸ“¥ DOWNLOAD</a>
        </div>
        <div class="col-6">
            <button onclick="bagikanVideo()" class="btn btn-primary w-100 fw-bold">ðŸ”— BAGIKAN</button>
        </div>
    </div>
</div>

<script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>

<script>
    // LOGIKA UPLOAD VIDEO
    var myWidget = cloudinary.createUploadWidget({
        cloudName: 'dumqnwl9g', 
        uploadPreset: 'upload video' 
    }, (error, result) => { 
        if (!error && result && result.event === "success") { 
            const url = result.info.secure_url;
            document.getElementById('videoSource').src = url;
            document.getElementById('btnDownload').href = url;
            document.getElementById('playerGibran').load();
            alert('Video Berhasil Diupdate!');
        }
    });

    document.getElementById("upload_widget").addEventListener("click", function(){ 
        myWidget.open(); 
    }, false);

    // LOGIKA BAGIKAN
    function bagikanVideo() {
        const url = document.getElementById('videoSource').src;
        if (navigator.share) {
            navigator.share({ title: 'Video Gibran Store', url: url });
        } else {
            navigator.clipboard.writeText(url);
            alert("Link video berhasil disalin!");
        }
    }

    // Pastikan link download siap pas halaman dibuka
    window.addEventListener('load', function() {
        const source = document.getElementById('videoSource');
        if(source) {
            document.getElementById('btnDownload').href = source.src;
        }
    });
