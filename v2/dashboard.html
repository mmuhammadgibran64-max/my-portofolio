<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Utama | M. Gibran</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #050505; --card: #111; --accent: #ff9800; --text: #fff; --border: #222; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: auto; }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); padding-bottom: 15px; margin-bottom: 30px; }
        #clock { font-size: 18px; font-weight: bold; color: var(--accent); }
        .panel { background: var(--card); padding: 25px; border-radius: 20px; border: 1px solid var(--border); margin-bottom: 25px; }
        #video-feed { width: 100%; border-radius: 15px; background: #000; transform: scaleX(-1); border: 1px solid #333; margin-bottom: 10px; }
        .btn { width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; display: block; text-align: center; text-decoration: none; font-size: 14px; transition: 0.3s; }
        .btn-accent { background: var(--accent); color: #000; }
        .btn-outline { background: #222; color: #fff; border: 1px solid #444; margin-top: 20px; }
        .upload-box { border: 2px dashed #444; padding: 40px 20px; text-align: center; border-radius: 15px; cursor: pointer; }
        #status-upload { font-size: 13px; color: var(--accent); margin-top: 15px; text-align: center; font-weight: 600; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2 style="margin:0;">Dashboard Utama</h2>
            <div id="clock">00:00:00</div>
        </div>

        <div class="panel">
            <h3><i class="fas fa-video"></i> Surveillance</h3>
            <video id="video-feed" autoplay playsinline></video>
            <button class="btn btn-accent" onclick="alert('✅ Absen Berhasil!')">SCAN WAJAH</button>
        </div>

        <div class="panel">
            <h3><i class="fas fa-cloud-upload-alt"></i> Upload Media</h3>
            <div class="upload-box" onclick="document.getElementById('fin').click()">
                <i class="fas fa-folder-plus" style="font-size: 40px; color: #333; margin-bottom: 15px;"></i>
                <p id="label-upload" style="margin:0; color: #888;">Pilih Foto/Video untuk disimpan</p>
                <input type="file" id="fin" hidden onchange="simpanKeStorage(this)">
            </div>
            <div id="status-upload"></div>

            <a href="dashboard-terpisah.html" class="btn btn-outline">
                <i class="fas fa-database"></i> BUKA DASHBOARD TERPISAH (GUDANG)
            </a>
        </div>

        <a href="index.html" style="color:#555; text-decoration:none; font-size:12px; display:block; text-align:center;">Kembali ke Depan</a>
    </div>

    <script>
        // Mesin Jam
        setInterval(() => { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }, 1000);
        
        // Mesin Kamera
        const v = document.getElementById('video-feed');
        if (navigator.mediaDevices) { navigator.mediaDevices.getUserMedia({ video: true }).then(s => v.srcObject = s); }

        // Mesin Simpan File
        function simpanKeStorage(input) {
            const file = input.files[0];
            const status = document.getElementById('status-upload');
            if (file) {
                status.innerHTML = "⏳ Memproses file...";
                const reader = new FileReader();
                reader.onload = function(e) {
                    let saved = JSON.parse(localStorage.getItem('gibran_files')) || [];
                    saved.push({ 
                        name: file.name, 
                        type: file.type, 
                        data: e.target.result, 
                        date: new Date().toLocaleString() 
                    });
                    localStorage.setItem('gibran_files', JSON.stringify(saved));
                    status.innerHTML = "✅ Berhasil Disimpan!";
                    alert("Mantap! Cek di Dashboard Terpisah sekarang.");
                };
                reader.readAsDataURL(file);
            }
        }
    </script>
</body>
</html>
