<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard M Gibran</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root { --primary: #38bdf8; --bg: #0f172a; --card: #1e293b; --text: #f8fafc; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; }
        .container { max-width: 500px; width: 90%; background: var(--card); padding: 40px; border-radius: 25px; text-align: center; box-shadow: 0 15px 50px rgba(0,0,0,0.6); border: 1px solid #334155; }
        
        /* Animasi Transisi */
        #login-box, #dashboard-box { transition: all 0.5s ease; }
        #dashboard-box { display: none; }

        .banner { width: 100%; padding: 25px 0; background: linear-gradient(135deg, #0ea5e9, #6366f1); border-radius: 20px; margin-bottom: 30px; }
        #clock { font-size: 3em; font-weight: bold; text-shadow: 2px 2px 10px rgba(0,0,0,0.3); }
        
        .welcome-text { font-size: 1.2em; color: var(--primary); font-weight: 600; margin-bottom: 10px; }
        .empty-dash { border: 2px dashed #475569; padding: 60px 20px; border-radius: 15px; color: #94a3b8; margin: 20px 0; }
        
        .btn-logout { background: #ef4444; color: white; border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-logout:hover { background: #dc2626; transform: scale(1.05); }
        
        .loading-dots:after { content: ' .'; animation: dots 1s steps(5, end) infinite;}
        @keyframes dots { 0%, 20% { color: rgba(0,0,0,0); text-shadow: .2em 0 0 rgba(0,0,0,0), .4em 0 0 rgba(0,0,0,0); } 40% { color: var(--primary); text-shadow: .2em 0 0 rgba(0,0,0,0), .4em 0 0 rgba(0,0,0,0); } 60% { text-shadow: .2em 0 0 var(--primary), .4em 0 0 rgba(0,0,0,0); } 80%, 100% { text-shadow: .2em 0 0 var(--primary), .4em 0 0 var(--primary); } }
    </style>
</head>
<body>

<div id="login-box" class="container">
    <div class="banner">
        <h2 style="margin:0;">GIBRAN PORTFOLIO</h2>
        <p style="opacity: 0.9; font-size: 14px;">Secure Dashboard Access</p>
    </div>
    
    <p class="welcome-text">Silakan Masuk</p>
    <p style="font-size: 14px; color: #94a3b8; margin-bottom: 30px;">Gunakan akun Google untuk verifikasi data ke sheet <b>daftar</b></p>

    <div style="display: flex; justify-content: center;">
        <div id="g_id_onload"
             data-client_id="594310366887-8b30jrckuekb2do01g1b9kl29lh3l9j6.apps.googleusercontent.com"
             data-context="signin"
             data-ux_mode="popup"
             data-callback="handleCredentialResponse"
             data-auto_prompt="false">
        </div>
        <div class="g_id_signin" data-type="standard" data-shape="pill" data-theme="filled_blue" data-size="large" data-text="signin_with"></div>
    </div>
    <p id="status" style="margin-top: 20px; font-size: 13px; min-height: 20px;"></p>
</div>

<div id="dashboard-box" class="container">
    <div class="banner">
        <div id="clock">00:00:00</div>
        <p style="margin: 5px 0 0 0; font-weight: bold;">SIT DASHBOARD AKTIF</p>
    </div>

    <div class="empty-dash">
        <p>ðŸ‘‹ Halo! Kamu berhasil masuk.</p>
        <p style="font-size: 12px; margin-top: 10px;">Data login kamu telah dikirim ke Google Sheet (Sheet: daftar).</p>
        <p style="font-size: 14px; color: var(--primary); margin-top: 20px;">[ Konten Dashboard Kosongan ]</p>
    </div>

    <button class="btn-logout" onclick="location.reload()">LOGOUT</button>
</div>

<script>
    // Jalankan Jam
    setInterval(() => {
        const clockEl = document.getElementById('clock');
        if(clockEl) clockEl.innerText = new Date().toLocaleTimeString('id-ID');
    }, 1000);

    // Fungsi Saat Google Berhasil Login
    function handleCredentialResponse(response) {
        const statusEl = document.getElementById('status');
        statusEl.className = "loading-dots";
        statusEl.innerText = "Mengirim data ke Sheet daftar";

        // LINK APPS SCRIPT BARU KAMU
        const scriptURL = "https://script.google.com/macros/s/AKfycbwCZnpxtHpRv3NyX3xA1YkAlQcUO9KE-Ilf0Uz_5dB2vxLcK57lKxa_A7drSlEY4J6hWg/exec";

        // Kirim sinyal ke Apps Script (nama & hp otomatis)
        fetch(scriptURL + "?nama=User_Google&hp=Aktif")
        .then(() => {
            // Pindah ke Halaman Dashboard
            document.getElementById('login-box').style.display = 'none';
            document.getElementById('dashboard-box').style.display = 'block';
        })
        .catch(err => {
            console.error("Gagal lapor ke sheet:", err);
            // Tetap masuk dashboard walau fetch gagal
            document.getElementById('login-box').style.display = 'none';
            document.getElementById('dashboard-box').style.display = 'block';
        });
    }
</script>

</body>
</html>
