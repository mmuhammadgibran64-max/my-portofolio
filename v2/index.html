<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIBRAN STORE | v.3.6.2 Full Version</title>
    <style>
        :root { --primary: #2563eb; --gold: #fbbf24; --slate: #1e293b; --success: #10b981; --dark: #020617; --light-bg: #f8fafc; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; transition: 0.3s; background: var(--dark); color: white; }
        
        body.gelap { background: var(--dark); color: white; }
        body.terang { background: var(--light-bg); color: #1e293b; }

        /* HEADER & NAVBAR */
        .navbar { 
            background: #1e293b; padding: 12px 15px; display: flex; 
            justify-content: space-between; align-items: center; 
            position: sticky; top: 0; z-index: 1000; border-bottom: 2px solid var(--gold); 
        }
        .nav-logo { font-size: 1.1rem; font-weight: bold; color: var(--gold); text-decoration: none; text-transform: uppercase; }
        .admin-nav-text { font-size: 0.7rem; color: #94a3b8; border: 1px solid #475569; padding: 4px 8px; border-radius: 5px; cursor: pointer; }

        /* DESKRIPSI TOKO (Yang Lo Maksud) */
        .store-desc { padding: 15px; text-align: center; background: #0f172a; border-bottom: 1px solid #334155; }
        .store-desc h2 { color: var(--gold); margin: 0; font-size: 1.2rem; }
        .store-desc p { font-size: 0.8rem; color: #94a3b8; margin: 5px 0 0 0; }

        .bottom-nav { background: #1e293b; padding: 10px; display: flex; justify-content: space-around; }
        .bottom-nav a { color: #cbd5e1; text-decoration: none; font-size: 0.8rem; cursor: pointer; }

        /* MODAL */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); }
        .modal-content { background: #1e293b; color: white; margin: 10% auto; padding: 25px; border-radius: 20px; width: 85%; max-width: 450px; border: 2px solid var(--gold); }
        
        /* CARDS */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(145px, 1fr)); gap: 12px; padding: 15px; }
        .product-card { background: white; color: #1e293b; padding: 12px; border-radius: 12px; text-align: center; }
        .btn-beli { background: var(--primary); color: white; border: none; padding: 8px; border-radius: 6px; width: 100%; cursor: pointer; font-weight: bold; margin-top: 8px; }

        /* GATE FORMS */
        .gate-container { display: flex; align-items: center; justify-content: center; min-height: 80vh; padding: 20px; }
        .gate-card { background: #1e293b; padding: 30px; border-radius: 20px; width: 100%; max-width: 380px; text-align: center; border: 1px solid #334155; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; box-sizing: border-box; }
        .btn-big { width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body class="gelap">

<nav id="main-navbar" class="navbar" style="display: none;">
    <a href="#" class="nav-logo">GIBRAN STORE</a>
    <div class="admin-nav-text" onclick="openModal('modal-admin')">ADMIN CONTROL</div>
</nav>

<div id="store-header" class="store-desc" style="display: none;">
    <h2>Selamat Datang</h2>
    <p>Penyedia jajanan dan kebutuhan harian terlengkap di area Anda. Kualitas terjamin, harga bersahabat!</p>
</div>

<div id="sub-nav" class="bottom-nav" style="display: none;">
    <a onclick="location.reload()">KATALOG</a>
    <a onclick="openModal('modal-history')">RIWAYAT</a>
    <a onclick="openModal('modal-settings')">PENGATURAN</a>
</div>

<div id="modal-admin" class="modal">
    <div class="modal-content">
        <h3 style="color:var(--gold);">üõ†Ô∏è ADMIN CONTROL</h3>
        <p style="font-size:0.8rem;">Email: <strong>mmgibran941@gmail.com</strong></p>
        <p style="font-size:0.8rem;">WhatsApp: <strong>+62 851-2333-2018</strong></p>
        <a href="mailto:mmgibran941@gmail.com" style="display:block; background:var(--primary); color:white; padding:10px; text-align:center; border-radius:8px; text-decoration:none; margin-bottom:10px;">Kirim Email</a>
        <a href="https://wa.me/6285123332018" style="display:block; background:var(--success); color:white; padding:10px; text-align:center; border-radius:8px; text-decoration:none;">Chat WhatsApp</a>
        <button class="btn-big" style="background:var(--slate); margin-top:15px;" onclick="closeModal('modal-admin')">TUTUP</button>
    </div>
</div>

<div id="reg-screen" class="gate-container">
    <div class="gate-card">
        <h2 style="color:var(--gold);">DAFTAR MEMBER</h2>
        <form id="form-register">
            <input type="date" name="tanggal" id="reg-date" required>
            <input type="text" name="nama" placeholder="Nama Lengkap" required>
            <input type="number" name="whatsapp" placeholder="WhatsApp" required>
            <textarea name="alamat" placeholder="Alamat Lengkap" required></textarea>
            <input type="hidden" name="sheetTarget" value="register.html">
            <button type="submit" id="btn-submit-reg" class="btn-big" style="background:var(--gold); color:black;">DAFTAR SEKARANG</button>
        </form>
        <button id="btn-to-login" class="btn-big" style="display:none; background:var(--primary); color:white;" onclick="showLogin()">SUDAH DAFTAR? LOGIN</button>
    </div>
</div>

<div id="login-screen" class="gate-container" style="display:none;">
    <div class="gate-card">
        <h2 style="color:var(--primary);">MASUK TOKO</h2>
        <form id="form-login">
            <input type="text" id="l-nama" name="nama" placeholder="Nama Anda" required>
            <input type="number" id="l-wa" name="whatsapp" placeholder="Nomor WhatsApp" required>
            <input type="text" id="l-rumah" name="no_rumah" placeholder="Nomor Rumah (Blok/No)" required>
            <input type="hidden" name="sheetTarget" value="User">
            <button type="submit" id="btn-submit-login" class="btn-big" style="background:var(--primary); color:white;">MASUK KE KATALOG</button>
        </form>
    </div>
</div>

<div id="shop-content" style="display:none;">
    <div class="product-grid">
        <script>
            const items = [
                {n: "Peye Kacang (Kecil)", p: "Rp5.000"}, {n: "Peye Kacang (Besar)", p: "Rp10.000"},
                {n: "Slondok", p: "Rp20.000"}, {n: "Opak", p: "Rp20.000"},
                {n: "Kacang", p: "Rp2.000"}, {n: "Kripik Pedes", p: "Rp15.000"},
                {n: "Kue Sus Kering", p: "Rp15.000"}, {n: "Reginang (isi 3)", p: "Rp5.000"},
                {n: "Aqua Galon", p: "Rp22.000"}
            ];
            document.write(items.map(i => `
                <div class="product-card">
                    <h4 style="font-size:0.9rem; margin:5px 0;">${i.n}</h4>
                    <p style="color:var(--primary); font-size:0.85rem; font-weight:bold;">${i.p}</p>
                    <button class="btn-beli" onclick="startPay('${i.n}', '${i.p}')">Beli</button>
                </div>
            `).join(''));
        </script>
    </div>
</div>

<div id="modal-history" class="modal"><div class="modal-content"><h3 style="color:var(--gold);">RIWAYAT</h3><div id="history-list"></div><button class="btn-big" onclick="closeModal('modal-history')">TUTUP</button></div></div>
<div id="modal-settings" class="modal"><div class="modal-content"><h3>PENGATURAN</h3><select onchange="document.body.className = this.value"><option value="gelap">Mode Gelap</option><option value="terang">Mode Terang</option></select><button class="btn-big" onclick="closeModal('modal-settings')" style="margin-top:10px;">SIMPAN</button></div></div>

<div id="pay-screen" class="gate-container" style="display:none;">
    <div class="gate-card" style="border: 2px solid var(--gold);">
        <h3>KONFIRMASI</h3>
        <p id="item-info"></p>
        <form id="form-order">
            <input type="hidden" name="sheetTarget" value="Order"><input type="hidden" name="Nama" id="o-nama"><input type="hidden" name="No HP" id="o-hp"><input type="hidden" name="Total" id="o-total"><input type="hidden" name="Alamat" id="o-alamat"><input type="hidden" name="Tanggal" id="o-tgl">
            <button type="submit" id="btn-pay" class="btn-big" style="background:var(--success); color:white;">BELI SEKARANG</button>
            <button type="button" onclick="location.reload()" style="background:none; color:gray; border:none; margin-top:10px; cursor:pointer;">Batal</button>
        </form>
    </div>
</div>

<script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwS6CvxXW8lmHPZvPR0-S1XzV3pyODxKOvcDpW1--PgvdqwHLcJz9s3gMDJe9rgvuXnng/exec';
    let user = { n: "", w: "", a: "" };
    document.getElementById('reg-date').valueAsDate = new Date();

    function openModal(id) { document.getElementById(id).style.display='block'; }
    function closeModal(id) { document.getElementById(id).style.display='none'; }
    function showLogin() { document.getElementById('reg-screen').style.display='none'; document.getElementById('login-screen').style.display='flex'; }

    async function postData(f) { return fetch(SCRIPT_URL, { method: 'POST', body: new FormData(f), mode: 'no-cors' }); }

    document.getElementById('form-register').onsubmit = async e => {
        e.preventDefault();
        document.getElementById('btn-submit-reg').innerText = "Processing...";
        await postData(e.target);
        alert('Registrasi Berhasil!');
        document.getElementById('form-register').style.display='none';
        document.getElementById('btn-to-login').style.display='block';
    };

    document.getElementById('form-login').onsubmit = async e => {
        e.preventDefault();
        document.getElementById('btn-submit-login').innerText = "Verifikasi...";
        user = { n: document.getElementById('l-nama').value, w: document.getElementById('l-wa').value, a: document.getElementById('l-rumah').value };
        await postData(e.target);
        document.getElementById('login-screen').style.display='none';
        document.getElementById('main-navbar').style.display='flex';
        document.getElementById('store-header').style.display='block';
        document.getElementById('sub-nav').style.display='flex';
        document.getElementById('shop-content').style.display='block';
    };

    function startPay(n, p) {
        document.getElementById('shop-content').style.display='none';
        document.getElementById('main-navbar').style.display='none';
        document.getElementById('store-header').style.display='none';
        document.getElementById('sub-nav').style.display='none';
        document.getElementById('pay-screen').style.display='flex';
        document.getElementById('item-info').innerText = n + " (" + p + ")";
        document.getElementById('o-nama').value = user.n;
        document.getElementById('o-hp').value = "'" + user.w;
        document.getElementById('o-total').value = p + " [" + n + "]";
        document.getElementById('o-alamat').value = user.a;
        document.getElementById('o-tgl').value = new Date().toLocaleString('id-ID');
    }

    document.getElementById('form-order').onsubmit = async e => {
        e.preventDefault();
        document.getElementById('btn-pay').innerText = "Sending...";
        await postData(e.target);
        alert('Terima kasih! Pesanan Anda sedang diproses.');
        location.reload();
    };
</script>
</body>
</html>
