<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Olshop Sync v3.8.9 BETA</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #0a0a0a; --card: #1a1a1a; --text: #fff; --accent: #00ff88; --danger: #ff4444; --beta: #ffaa00; }
        [data-theme="light"] { --bg: #f8f9fa; --card: #fff; --text: #333; --accent: #00cc70; --danger: #dc3545; --beta: #ffc107; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Inter', -apple-system, sans-serif; 
            background: var(--bg); color: var(--text); padding: 20px; transition: all 0.3s; 
        }
        .dashboard { max-width: 1600px; margin: 0 auto; }
        .header { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 30px; flex-wrap: wrap; gap: 10px; position: relative; 
        }
        .logo { 
            font-size: 28px; font-weight: 800; background: linear-gradient(135deg, var(--accent), #00cc70); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
        }
        .version { font-size: 12px; color: var(--beta); font-weight: bold; padding: 4px 8px; border-radius: 12px; background: rgba(255,170,0,0.2); animation: pulse 2s infinite; }
        @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:0.5;} }
        .controls { display: flex; gap: 10px; align-items: center; }
        .search-input { 
            background: var(--card); color: var(--text); border: 1px solid #333; padding: 10px; border-radius: 8px; width: 200px; 
        }
        .profile-section { display: flex; gap: 10px; align-items: center; position: relative; }
        .profile { 
            background: var(--card); border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; 
            cursor: pointer; font-size: 20px; 
        }
        .logout-btn, .theme-toggle { 
            background: var(--card); color: var(--text); border: 1px solid #333; padding: 10px 16px; border-radius: 8px; cursor: pointer; 
            transition: 0.3s; 
        }
        .settings-dropdown { 
            position: absolute; top: 100%; right: 0; background: var(--card); border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); 
            min-width: 280px; padding: 15px; display: none; z-index: 100; border: 1px solid rgba(255,255,255,0.1); 
        }
        .settings-dropdown.active { display: block; animation: slideDown 0.3s; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .settings-item { display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; cursor: pointer; transition: 0.3s; margin-bottom: 5px; }
        .settings-item:hover { background: rgba(0,255,136,0.1); }
        .settings-icon { font-size: 20px; }
        #videoPreview { width: 100%; max-width: 250px; border-radius: 8px; display: none; }
        .stats-grid, .charts-section, .devices-grid { /* Same as v2 */ 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; 
        }
        .stat-card, .chart-card, .device-card { /* Same styling as v2 with beta glow */ 
            background: var(--card); padding: 25px; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); 
            transition: all 0.3s; border: 1px solid rgba(255,170,0,0.2); /* Beta border */ 
        }
        .stat-card:hover { box-shadow: 0 20px 50px rgba(255,170,0,0.3); }
        footer { text-align: center; padding: 20px; font-size: 12px; color: #aaa; border-top: 1px solid #333; margin-top: 30px; }
        canvas { max-height: 300px; }
        /* Rest of styles from v2... (copy jika perlu, tapi simplified) */
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div class="logo">ðŸŒŸ Olshop Sync</div>
                <span class="version" title="Beta - Features coming soon!">v3.8.9 BETA</span>
            </div>
            <div class="controls">
                <input type="text" class="search-input" placeholder="ðŸ” Cari...">
                <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™</button>
                <div class="profile-section">
                    <div class="profile" onclick="toggleSettings()" title="Pengaturan">ðŸ‘¤</div>
                    <div class="settings-dropdown" id="settingsDropdown">
                        <div class="settings-item" onclick="startFaceAbsen()">
                            <span class="settings-icon">ðŸŽ¥</span>
                            <span>Absen Muka Beneran</span>
                        </div>
                        <div class="settings-item" onclick="toggleSchedule('sabtu')">
                            <span class="settings-icon">ðŸ“…</span>
                            <span>Jadwal Update Sabtu <span id="sabtuToggle">(Off)</span></span>
                        </div>
                        <div class="settings-item" onclick="toggleSchedule('weekend')">
                            <span class="settings-icon">ðŸ“†</span>
                            <span>Update Sabtu-Minggu <span id="weekendToggle">(Off)</span></span>
                        </div>
                    </div>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>
        </div>
        
        <!-- Stats, Charts, Devices grids sama seperti v2 â€“ simplified untuk brevitas -->
        <div class="stats-grid">
            <div class="stat-card"><div>ðŸ’°</div><div class="stat-value">$15,200</div><div>USDT</div><div class="up">+4.2%</div></div>
            <div class="stat-card"><div>ðŸª™</div><div class="stat-value">$10,100</div><div>AUSDT</div><div class="down">-0.2%</div></div>
            <div class="stat-card"><div>ðŸ“ˆ</div><div class="stat-value">2,500</div><div>Transaksi</div><div class="up">+25%</div></div>
            <div class="stat-card"><div>âš¡</div><div class="stat-value">100%</div><div>Sync</div><div class="up">âœ“</div></div>
        </div>
        
        <div class="charts-section" style="grid-template-columns: 1fr; gap: 20px;">
            <canvas id="mainChart" width="400" height="200" style="background: var(--card); padding: 20px; border-radius: 16px; display: block; margin: 0 auto;"></canvas>
        </div>
        
        <div class="devices-grid">
            <div class="device-card">ðŸ“± Android Online</div>
            <div class="device-card">ðŸ’» Desktop Active</div>
            <div class="device-card">ðŸ“² iOS Pending</div>
        </div>
        
        <!-- Absen Video Preview -->
        <video id="videoPreview" autoplay playsinline></video>
        
        <footer>v3.8.9 BETA - Update otomatis diaktifkan. Â© Olshop Sync 2026</footer>
    </div>

    <script>
        let video = document.getElementById('videoPreview');
        let mediaStream;
        
        // Toggle Settings Dropdown
        function toggleSettings() {
            document.getElementById('settingsDropdown').classList.toggle('active');
        }
        
        // Absen Muka Beneran
        async function startFaceAbsen() {
            try {
                mediaStream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = mediaStream;
                video.style.display = 'block';
                video.style.position = 'fixed';
                video.style.top = '50%';
                video.style.left = '50%';
                video.style.transform = 'translate(-50%, -50%)';
                video.style.zIndex = '9999';
                video.style.border = '3px solid var(--accent)';
                video.style.borderRadius = '12px';
                video.style.maxWidth = '80vw';
                video.style.maxHeight = '80vh';
                
                // Simple Face Detection (edge detection via canvas)
                setTimeout(() => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    ctx.drawImage(video, 0, 0);
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    // Simulate detection (real: use ml5.js or TensorFlow.js)
                    if (imageData.data.length > 0) {
                        alert('âœ… Absen Sukses! Wajah terdeteksi.');
                        stopFaceAbsen();
                    }
                }, 2000);
            } catch (err) {
                alert('âŒ Izinkan kamera dulu! ' + err.message);
            }
        }
        
        function stopFaceAbsen() {
            if (mediaStream) {
                mediaStream.getTracks().forEach(track => track.stop());
                video.style.display = 'none';
            }
        }
        
        // Jadwal Update
        function toggleSchedule(type) {
            const toggle = document.getElementById(type + 'Toggle');
            if (toggle.textContent === '(Off)') {
                toggle.textContent = '(On)';
                toggle.style.color = 'var(--accent)';
                // Simulate API call for schedule (Sabtu only / Weekend)
                console.log(`Jadwal ${type} diaktifkan! Auto-update ${type === 'sabtu' ? 'setiap Sabtu' : 'Sabtu-Minggu'}`);
            } else {
                toggle.textContent = '(Off)';
                toggle.style.color = 'inherit';
            }
        }
        
        // Logout
        function logout() {
            if (confirm('Logout sekarang?')) {
                alert('Logged out! Redirecting...');
                // window.location.href = '/login';
            }
        }
        
        // Theme & Chart init (from v2)
        function toggleTheme() {
            document.body.dataset.theme = document.body.dataset.theme === 'light' ? 'dark' : 'light';
        }
        
        // Simple Chart
        window.onload = () => {
            const ctx = document.getElementById('mainChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: { labels: ['Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab'], datasets: [{ label: 'USDT', data: [100, 150, 120, 180, 160, 220], borderColor: 'var(--accent)' }] }
            });
        };
        
        // Close dropdown on outside click
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.profile-section')) toggleSettings();
        });
    </script>
</body>
</html>
