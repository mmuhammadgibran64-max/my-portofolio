<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIBRAN STORE | v.3.4.9 Official</title>
    <style>
        :root { --primary: #2563eb; --gold: #fbbf24; --slate: #1e293b; --success: #10b981; --dark: #020617; --light-bg: #f8fafc; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; transition: 0.3s; background: var(--dark); color: white; }
        
        /* Tema Terang & Gelap */
        body.gelap { background: var(--dark); color: white; }
        body.terang { background: var(--light-bg); color: #1e293b; }
        body.terang .product-card { border: 1px solid #cbd5e1; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }

        /* NAVBAR (Sesuai Foto 2) */
        .navbar {
            background: #1e293b; padding: 15px 25px; display: flex;
            justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid #334155;
        }
        .nav-logo { font-size: 1.3rem; font-weight: bold; color: var(--gold); text-decoration: none; text-transform: uppercase; }
        .nav-links { display: flex; gap: 20px; }
        .nav-links a { color: #94a3b8; text-decoration: none; font-size: 0.9rem; cursor: pointer; transition: 0.3s; }
        .nav-links a:hover { color: var(--gold); }
        .btn-out { background: #ef4444; color: white; border: none; padding: 5px 12px; border-radius: 5px; cursor: pointer; font-weight: bold; }

        /* MODAL PENGATURAN */
        .modal-settings {
            display: none; position: fixed; z-index: 2000; left: 0; top: 0;
            width: 100%; height: 100%; background: rgba(0,0,0,0.85); overflow-y: auto;
        }
        .modal-content {
            background: #1e293b; color: white; margin: 5% auto; padding: 30px;
            border-radius: 20px; width: 90%; max-width: 500px; border: 2px solid var(--gold);
        }
        .setting-section { margin-bottom: 20px; border-bottom: 1px solid #334155; padding-bottom: 15px; }
        .setting-section h4 { margin: 0 0 10px 0; color: var(--gold); text-transform: uppercase; font-size: 0.85rem; }
        .lock-badge { background: #475569; font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; vertical-align: middle; }

        /* KATALOG GRID (Sesuai Foto 2) */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; padding: 20px; max-width: 1200px; margin: auto; }
        .product-card { background: white; color: #1e293b; padding: 20px; border-radius: 12px; text-align: center; }
        .product-card h4 { margin: 10px 0 5px 0; font-size: 1rem; }
        .product-card p { color: var(--primary); font-weight: bold; margin-bottom: 15px; }
        .btn-beli-kecil { background: #e2e8f0; border: 1px solid #cbd5e1; padding: 5px 15px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; }

        /* FORMS */
        .gate-container { display: flex; align-items: center; justify-content: center; min-height: 90vh; padding: 20px; }
        .gate-card { background: #1e293b; padding: 40px; border-radius: 20px; width: 100%; max-width: 400px; text-align: center; border: 1px solid #334155; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; box-sizing: border-box; }
        .btn-big { width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 1rem; }
    </style>
</head>
<body class="gelap">

<nav id="main-navbar" class="navbar" style="display: none;">
    <a href="#" class="nav-logo">Gibran Store</a>
    <div class="nav-links">
        <a onclick="location.reload()">Katalog</a>
        <a onclick="openSettings()">Pengaturan</a>
    </div>
    <button class="btn-out" onclick="location.reload()">Out</button>
</nav>

<div id="modal-settings" class="modal-settings">
    <div class="modal-content">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <h3 style="margin:0;">‚öôÔ∏è PENGATURAN TOKO</h3>
            <span style="cursor:pointer; font-size:1.5rem;" onclick="closeSettings()">&times;</span>
        </div>
        
        <div class="setting-section">
            <h4>Jam Operasional (Senin-Kamis)</h4>
            <div style="display:flex; gap:10px;">
                <div style="flex:1;"><label style="font-size:0.7rem;">Buka</label><input type="text" value="08:00" readonly></div>
                <div style="flex:1;"><label style="font-size:0.7rem;">Tutup</label><input type="text" value="20:00" readonly></div>
            </div>
            <p style="font-size:0.7rem; color:var(--success);">‚óè Jadwal Update Terkini</p>
        </div>

        <div class="setting-section">
            <h4>Pencahayaan</h4>
            <select onchange="changeTheme(this.value)">
                <option value="gelap">Mode Gelap (Gelap)</option>
                <option value="terang">Mode Terang (Terang)</option>
            </select>
        </div>

        <div class="setting-section">
            <h4>Identitas & Deskripsi</h4>
            <p style="font-size:0.8rem; margin:0;"><strong>Nama & Logo:</strong> Identitas visual brand Anda</p>
            <p style="font-size:0.8rem; margin:5px 0;"><strong>Deskripsi:</strong> Penjelasan singkat mengenai apa yang Anda jual.</p>
        </div>

        <div class="setting-section">
            <h4>Ekspedisi & Chat <span class="lock-badge">LOCKED üîí</span></h4>
            <p style="font-size:0.7rem; color:#94a3b8;">JNE, J&T, GoSend & Template Auto-Reply FAQ.</p>
        </div>

        <p style="text-align:center; font-size:0.7rem; color:#94a3b8; margin-top:20px;">Aplikasi v.3.4.9</p>
        <button class="btn-big" style="background:var(--success); color:white;" onclick="closeSettings()">SIMPAN & UPDATE</button>
    </div>
</div>

<div id="reg-screen" class="gate-container">
    <div class="gate-card">
        <h2 style="color:var(--gold); margin-bottom:5px;">GIBRAN STORE</h2>
        <p style="font-size:0.8rem; margin-bottom:20px;">Daftar Member Baru</p>
        <form id="form-register">
            <input type="date" name="tanggal" onclick="this.showPicker()" required>
            <input type="text" name="nama" placeholder="Nama Lengkap" required>
            <input type="number" name="whatsapp" placeholder="Nomor WhatsApp" required>
            <textarea name="alamat" placeholder="Alamat Lengkap" required></textarea>
            <input type="hidden" name="sheetTarget" value="register.html">
            <button type="submit" id="btn-reg" class="btn-big" style="background:var(--gold); color:black;">DAFTAR</button>
        </form>
        <button id="btn-to-login" class="btn-big" style="display:none; background:var(--primary); color:white;" onclick="showLogin()">LANJUT LOGIN</button>
    </div>
</div>

<div id="login-screen" class="gate-container" style="display:none;">
    <div class="gate-card">
        <h2 style="color:var(--primary);">LOGIN</h2>
        <form id="form-login">
            <input type="text" name="nama" id="l-nama" placeholder="Nama" required>
            <input type="number" name="whatsapp" id="l-wa" placeholder="WhatsApp" required>
            <input type="text" name="no_rumah" id="l-rumah" placeholder="Nomor Rumah" required>
            <input type="hidden" name="sheetTarget" value="User">
            <button type="submit" id="btn-login" class="btn-big" style="background:var(--primary); color:white;">MASUK TOKO</button>
        </form>
    </div>
</div>

<div id="shop-content" style="display:none;">
    <h2 style="text-align:center; color:var(--gold); margin-top:30px;">KATALOG PRODUK</h2>
    <p style="text-align:center; font-size:0.8rem; margin-bottom:20px;">Selamat Datang di Toko Gibran</p>
    <div class="product-grid">
        <script>
            const items = [
                {n: "Peye Kacang (Kecil)", p: "Rp5.000"}, {n: "Peye Kacang (Besar)", p: "Rp10.000"},
                {n: "Slondok", p: "Rp20.000"}, {n: "Opak", p: "Rp20.000"},
                {n: "Kacang", p: "Rp2.000"}, {n: "Kripik Pedes", p: "Rp15.000"},
                {n: "Kue Sus Kering", p: "Rp15.000"}, {n: "Reginang (isi 3)", p: "Rp5.000"},
                {n: "Aqua Galon", p: "Rp22.000"}
            ];
            document.write(items.map(i => `
                <div class="product-card">
                    <h4>${i.n}</h4>
                    <p>${i.p}</p>
                    <button class="btn-beli-kecil" onclick="startPay('${i.n}', '${i.p}')">Beli</button>
                </div>
            `).join(''));
        </script>
    </div>
</div>

<div id="pay-screen" class="gate-container" style="display:none;">
    <div class="gate-card" style="border: 2px solid var(--gold);">
        <h3 style="color:var(--gold);">DETAIL PESANAN</h3>
        <div style="text-align:left; background:#0f172a; padding:15px; border-radius:10px; margin:15px 0;">
            <p style="margin:5px 0; font-size:0.9rem;">Produk: <span id="item-n"></span></p>
            <p style="margin:5px 0; font-weight:bold;">Total: <span id="item-p"></span></p>
        </div>
        <form id="form-order">
            <input type="hidden" name="sheetTarget" value="Order">
            <input type="hidden" name="Nama" id="o-nama">
            <input type="hidden" name="No HP" id="o-hp">
            <input type="hidden" name="Total" id="o-total">
            <input type="hidden" name="Alamat" id="o-alamat">
            <input type="hidden" name="Tanggal" id="o-tgl">
            
            <select name="metode">
                <option value="Cash">Cash (Bayar di Tempat) ‚úÖ</option>
                <option value="QRIS" disabled>QRIS (Kunci üîí)</option>
            </select>
            <button type="submit" id="btn-pay" class="btn-big" style="background:var(--success); color:white;">KONFIRMASI BAYAR</button>
            <button type="button" onclick="backToShop()" style="background:none; color:gray; border:none; margin-top:10px; cursor:pointer;">Batal</button>
        </form>
    </div>
</div>

<script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwS6CvxXW8lmHPZvPR0-S1XzV3pyODxKOvcDpW1--PgvdqwHLcJz9s3gMDJe9rgvuXnng/exec';
    let user = { n: "", w: "", a: "" };

    // SETTINGS LOGIC
    function openSettings() { document.getElementById('modal-settings').style.display='block'; }
    function closeSettings() { document.getElementById('modal-settings').style.display='none'; }
    function changeTheme(v) { document.body.className = v; }

    function showLogin() { document.getElementById('reg-screen').style.display='none'; document.getElementById('login-screen').style.display='flex'; }
    function backToShop() { document.getElementById('pay-screen').style.display='none'; document.getElementById('shop-content').style.display='block'; document.getElementById('main-navbar').style.display='flex'; }

    // AJAX POST
    async function postData(f) { return fetch(SCRIPT_URL, { method: 'POST', body: new FormData(f), mode: 'no-cors' }); }

    document.getElementById('form-register').onsubmit = async e => {
        e.preventDefault();
        document.getElementById('btn-reg').innerText = "Loading...";
        await postData(e.target);
        alert('Daftar Sukses!');
        document.getElementById('form-register').style.display='none';
        document.getElementById('btn-to-login').style.display='block';
    };

    document.getElementById('form-login').onsubmit = async e => {
        e.preventDefault();
        user = { n: document.getElementById('l-nama').value, w: document.getElementById('l-wa').value, a: document.getElementById('l-rumah').value };
        await postData(e.target);
        document.getElementById('login-screen').style.display='none';
        document.getElementById('main-navbar').style.display='flex';
        document.getElementById('shop-content').style.display='block';
    };

    function startPay(n, p) {
        document.getElementById('shop-content').style.display='none';
        document.getElementById('main-navbar').style.display='none';
        document.getElementById('pay-screen').style.display='flex';
        document.getElementById('item-n').innerText = n;
        document.getElementById('item-p').innerText = p;
        
        document.getElementById('o-nama').value = user.n;
        document.getElementById('o-hp').value = "'" + user.w;
        document.getElementById('o-total').value = p + " (" + n + ")";
        document.getElementById('o-alamat').value = user.a;
        document.getElementById('o-tgl').value = new Date().toLocaleString('id-ID');
    }

    document.getElementById('form-order').onsubmit = async e => {
        e.preventDefault();
        document.getElementById('btn-pay').innerText = "Mengirim...";
        await postData(e.target);
        alert('Pesanan Diterima!');
        location.reload();
    };
</script>
</body>
</html>
