<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIBRAN STORE | Order System</title>
    <style>
        :root {
            --primary: #2563eb; --dark: #020617; --gold: #fbbf24; --slate: #1e293b; --success: #10b981;
        }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #020617; color: white; }
        
        .gate-container { display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
        .gate-card { 
            background: var(--slate); padding: 40px; border-radius: 20px; 
            width: 100%; max-width: 450px; text-align: center;
            border: 1px solid #334155; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
        }
        label { display: block; text-align: left; font-size: 0.8rem; color: #94a3b8; margin-top: 10px; }
        
        input, textarea, select { 
            width: 100%; padding: 12px; margin: 5px 0 15px 0; border-radius: 10px; 
            border: 1px solid #334155; background: #0f172a; color: white; box-sizing: border-box;
            color-scheme: dark; font-size: 1rem;
        }
        
        option:disabled { color: #475569; }

        .btn-shop { width: 100%; padding: 14px; margin-top: 10px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; }
        .btn-reg { background: var(--gold); color: #000; }
        .btn-log { background: var(--primary); color: white; }

        #shop-content, #pembayaran-screen { display: none; padding: 30px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .product-card { background: white; color: #334155; padding: 15px; border-radius: 15px; text-align: center; border: 1px solid #e2e8f0; }
        .btn-beli { background: var(--gold); color: #000; padding: 10px; width: 100%; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        
        .pay-card { background: var(--slate); padding: 30px; border-radius: 20px; max-width: 500px; margin: auto; text-align: center; border: 2px solid var(--gold); }
    </style>
</head>
<body>

<div id="reg-screen" class="gate-container">
    <div class="gate-card">
        <h2 style="color:var(--gold)">GIBRAN STORE</h2>
        <form id="form-register-toko">
            <input type="date" name="tanggal" onclick="this.showPicker()" required>
            <input type="text" name="nama" placeholder="Nama Lengkap" required>
            <input type="number" name="whatsapp" placeholder="WhatsApp" required>
            <textarea name="alamat" placeholder="Alamat Lengkap" required></textarea>
            <input type="hidden" name="sheetTarget" value="register.html">
            <button type="submit" id="btn-submit-reg" class="btn-shop btn-reg">DAFTAR SEKARANG</button>
        </form>
        <button id="goto-login-btn" class="btn-shop btn-log" style="display:none;" onclick="showLogin()">MENU LOGIN</button>
    </div>
</div>

<div id="login-screen" class="gate-container" style="display:none;">
    <div class="gate-card">
        <h2 style="color:var(--primary)">LOGIN USER</h2>
        <form id="form-login-toko">
            <input type="text" name="nama" id="login-nama" placeholder="Nama Lengkap" required>
            <input type="number" name="whatsapp" id="login-wa" placeholder="Nomor WhatsApp" required>
            <input type="text" name="no_rumah" id="login-rumah" placeholder="Nomor Rumah" required>
            <input type="hidden" name="sheetTarget" value="User">
            <button type="submit" id="btn-submit-login" class="btn-shop btn-log">MASUK KE KATALOG</button>
        </form>
    </div>
</div>

<div id="shop-content">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2 style="color:var(--gold)">KATALOG PRODUK</h2>
        <button onclick="location.reload()" style="background:red; color:white; border:none; padding:8px 15px; border-radius:8px; cursor:pointer;">LOGOUT</button>
    </div>
    <div id="katalog-display" class="product-grid">
        <script>
            const menus = [
                {n: "Peye Kacang (Kecil)", p: "Rp5.000"}, {n: "Peye Kacang (Besar)", p: "Rp10.000"},
                {n: "Slondok", p: "Rp20.000"}, {n: "Opak", p: "Rp20.000"},
                {n: "Kacang", p: "Rp2.000"}, {n: "Kripik Pedes", p: "Rp15.000"},
                {n: "Kue Sus Kering", p: "Rp15.000"}, {n: "Reginang (isi 3)", p: "Rp5.000"},
                {n: "Aqua Galon", p: "Rp22.000"}
            ];
            document.write(menus.map(m => `
                <div class="product-card">
                    <h4>${m.n}</h4>
                    <p style="color:var(--primary); font-weight:bold">${m.p}</p>
                    <button onclick="openPayment('${m.n}', '${m.p}')" class="btn-beli">Tambah ke keranjang</button>
                </div>
            `).join(''));
        </script>
    </div>
</div>

<div id="pembayaran-screen" class="gate-container">
    <div class="pay-card">
        <h2 style="color:var(--gold)">CHECKOUT PESANAN</h2>
        <div style="text-align:left; margin:20px 0; background:#0f172a; padding:15px; border-radius:10px;">
            <p><strong>Item:</strong> <span id="display-produk"></span></p>
            <p><strong>Total:</strong> <span id="display-harga"></span></p>
        </div>
        
        <form id="form-order-toko">
            <input type="hidden" name="sheetTarget" value="Order">
            <input type="hidden" name="Nama" id="ord-nama">
            <input type="hidden" name="No HP" id="ord-hp">
            <input type="hidden" name="Total" id="ord-total">
            <input type="hidden" name="Alamat" id="ord-alamat">
            <input type="hidden" name="Tanggal" id="ord-tanggal">
            
            <label>Pilih Metode Pembayaran:</label>
            <select name="metode" required>
                <option value="Cash">Cash (Bayar di Tempat) âœ…</option>
                <option value="QRIS" disabled>QRIS (Locked ðŸ”’)</option>
                <option value="Transfer" disabled>Transfer Bank (Locked ðŸ”’)</option>
            </select>

            <button type="submit" id="btn-proses-order" class="btn-shop" style="background:var(--success); color:white;">KONFIRMASI PESANAN</button>
            <button type="button" onclick="batalOrder()" style="background:none; color:#94a3b8; border:none; margin-top:10px; cursor:pointer;">Batal</button>
        </form>
    </div>
</div>

<script>
    // LINK BARU PUNYA GIBRAN
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyLotCU6urUxd0frKUKiUtOBoe_9WNxRYZK3mjY5Wd_c6hQOST7Q_ooAKG9e89QW2AqHA/exec';
    
    let userData = { nama: "", wa: "", alamat: "" };

    function showLogin() { document.getElementById('reg-screen').style.display='none'; document.getElementById('login-screen').style.display='flex'; }

    document.getElementById('form-register-toko').onsubmit = e => {
        e.preventDefault();
        fetch(SCRIPT_URL, { method: 'POST', body: new FormData(e.target), mode: 'no-cors' })
        .then(() => { alert('Daftar Berhasil!'); document.getElementById('form-register-toko').style.display='none'; document.getElementById('goto-login-btn').style.display='block'; });
    };

    document.getElementById('form-login-toko').onsubmit = e => {
        e.preventDefault();
        userData.nama = document.getElementById('login-nama').value;
        userData.wa = document.getElementById('login-wa').value;
        userData.alamat = document.getElementById('login-rumah').value;
        fetch(SCRIPT_URL, { method: 'POST', body: new FormData(e.target), mode: 'no-cors' })
        .then(() => { document.getElementById('login-screen').style.display='none'; document.getElementById('shop-content').style.display='block'; });
    };

    function openPayment(namaProduk, harga) {
        document.getElementById('shop-content').style.display='none';
        document.getElementById('pembayaran-screen').style.display='flex';
        document.getElementById('display-produk').innerText = namaProduk;
        document.getElementById('display-harga').innerText = harga;

        document.getElementById('ord-nama').value = userData.nama;
        document.getElementById('ord-hp').value = userData.wa;
        document.getElementById('ord-total').value = harga + " (" + namaProduk + ")";
        document.getElementById('ord-alamat').value = userData.alamat;
        document.getElementById('ord-tanggal').value = new Date().toLocaleString('id-ID');
    }

    function batalOrder() { document.getElementById('pembayaran-screen').style.display='none'; document.getElementById('shop-content').style.display='block'; }

    document.getElementById('form-order-toko').onsubmit = e => {
        e.preventDefault();
        const b = document.getElementById('btn-proses-order');
        b.innerText = "Mengirim..."; b.disabled = true;

        fetch(SCRIPT_URL, { method: 'POST', body: new FormData(e.target), mode: 'no-cors' })
        .then(() => {
            alert('Pesanan Sukses! Cek Sheet Order.');
            location.reload();
        });
    };
</script>
</body>
</html>
